import json
import re

from Utiles.format_output import extract_json_from_string


def test_json_ext():
    # 测试用例1：使用 ```json 标记
    test_string1 = '''
        一些其他文本
        ```json
        {
          "substitutions": {
            "髯": "胡子",
            "罡": "",
            "拈": "拿"
          },
          "simplified_text": "简化后的文本内容"
        }
        ```
        更多其他文本
        '''

    # 测试用例2：不使用 ```json 标记
    test_string2 = '''
        一些其他文本
        {
          "substitutions": {
            "髯": "胡子",
            "罡": "",
            "拈": "拿"
          },
          "simplified_text": "简化后的文本内容"
        }
        更多其他文本
        '''

    # 测试用例3：没有JSON数据
    test_string3 = "这是一个没有JSON数据的字符串"

    # 测试用例4
    test_string4 = '''```json
{
    "substitutions": {"镌": "雕刻"},
    "simplified_text": "推开祠庙前那两扇沉厚的暗红漆的大门，一条青砖步道便直贯而入，将庭院中分为二。道旁，夹峙着古碑数块。右边一块唐碑，高可丈五，碑帽雕刻有华美的云纹，距今已一千一百余岁。油黑的碑面上，铭刻着一篇褒颂诸葛亮的文字，作者是中唐名相裴度。由柳公绰（书法大师柳公权之兄）书写，工匠鲁健刻石。因文章、书法、刻字都很好，此碑有“三绝碑”之称。砖道左侧一碑立于明朝，碑身笨重，置于龟趺之上，碑文详细叙述了祠庙的来历和变迁。
武侯祠的建立也经历过一番曲折。据《三国志》裴注引《襄阳记》记载：“诸葛亮刚去世，各地都要求为他建庙，朝廷讨论认为不合礼制没有同意，百姓便在道路旁私下祭祀。有建议者认为可以在成都建庙，后主没有采纳。步兵校尉习隆、中书郎向充等人共同上表说：‘……诸葛亮的德行远近闻名，功绩盖世，王室没有败坏，实靠他……’于是才同意建立。”后魏将军钟会征蜀时，也“祭祀诸葛亮的庙”。"
}
```'''
    # 测试用例5
    test_string5 = '''{
    "substitutions": {"镌": "刻"},
    "simplified_text": "推开祠庙前那两扇沉厚的暗红漆的大门，一条青砖步道便直贯而入，将庭院中分为二。道旁，夹峙着古碑数块。右边一块唐碑，高约一丈五，碑帽刻有美丽的云纹，距今已有一千一百多年。油黑的碑面上，铭刻着一篇赞扬诸葛亮的文章，作者是中唐名相裴度。由柳公绰（书法大师柳公权的兄长）书写，工匠鲁健雕刻。因文章、书法、刻字都很好，此碑被誉为“三绝碑”。砖道左侧的一碑立于明朝，碑身厚实，坐落在龟形基座上，碑文详细记载了祠庙的来历和变迁。
武侯祠的建立也经历了一些波折。据《三国志》裴松之注引《襄阳记》记载：“诸葛亮初去世，各地都请求为他建立庙宇，朝廷商议认为不合礼制而不允许，百姓便在道路上季节性地私下祭祀。有人建议可以在成都为他立庙，后主刘禅没有同意。步兵校尉习隆、中书郎向充等人共同上表说：‘……诸葛亮的德行远近闻名，功绩盖世，王室没有败坏，实在是依靠了他……’于是才同意了。”后魏将军钟会征伐蜀国时，也‘祭祀诸葛亮的庙宇’。”
}'''

    for i, test_string in enumerate([test_string1, test_string2, test_string3, test_string4, test_string5], 1):
        print(f"\n测试用例 {i}:")
        result = extract_json_from_string(test_string)
        if result:
            print("提取的JSON数据:")
            print(json.dumps(result, ensure_ascii=False, indent=2))
        else:
            print("未能提取JSON数据")


if __name__ == '__main__':
    pass





